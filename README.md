# The crate for a simple zipping - simple_rust_zip

## Why

There are many good implementations of a zipping, however they are too
good. I need something very basic and simple.

##  How to use

First you need to create a zip file calling
```rust
let mut zip = simzip::ZipInfo::new_with_comment("test.zip", 
    "Generated by WebFolder (Java nio) 1.9.153, Copyright  â’¸ 2009, 2025 by Dmitriy Rogatkin");
```
Then you can add zip entries using:
```rust
zip.add(simzip::ZipEntry::new(".gitignore", r#"src/test
test.zip"#.as_bytes().to_vec()));
```
Or from a file:
```rust
zip.add(simzip::ZipEntry::from_file("README.md", Some("doc")));
```
A zip entry attributes can be changed using the technique:
```rust
entry.attributes.insert(simzip::Attribute::Exec);
```

Finally you can store the zip in the file system by calling:
```rust
match zip.store() {
   Ok(()) => println!{"Zipped good!"},
   Err(msg) => println!{"zip error: {msg}"}
}
```
The underline code will automatically add correct file permissions on UNIX systems.

There is nothing to prevent you to continue adding content after storing, and
then to store the zip again. But remember that repeating storing will overwrite a
previosly stored zip unless you change its name. A repeating `store` can be
useful in a case of an error like an insufficient disk space hoping that after some time
more space will be available.

## Limitations

- A created zip file can't exceed 2GB.
- A zip entry can't exceed available RAM size.
- Streaming can't be used, because some parts of the zip content gets updated after an initial
writing.

## Building the crate

Obtain the [RustBee](https://github.com/vernisaz/rust_bee) first. It's an alternative tool to Cargo.
You may need to build it for your platform. (Since **RustBee** uses the crate for itself, the crate
also gets built as a part of its bootstraping procedure)

The crate has one dependency [simtime](https://github.com/vernisaz/simtime). 
It has to be build in the common location
specified in [bee.7b](https://github.com/vernisaz/simple_rust_zip/blob/ce7bf7385eef7d8bd84690b7fefe82f2a0275d9f/bee.7b#L2).

Running the **rb** will create the **simzip** crate.

if you plan to *deflat* zip entires, then set the build script variable "use deflater" to **true** (default value). 
Use *deflater* [bee.7b](./libdeflate/bee.7b) to buiild the required crate. Read instructions inside the *bee.7b* how to build it.

## Future

1. More compressing algorithms (including encryption) can be added in the future.
2. Releasing the limitation having ZIP file under 2 GB, and adding 64 bit format support.
3. Adding unzipping capabilities.